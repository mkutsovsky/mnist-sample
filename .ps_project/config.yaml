
version: 1
type: "multi-grpc"
ports: "5000"
parameter-server:
  container: "tensorflow/tensorflow:latest-gpu-py3"
  command: "pip install gradient-sdk && python3 scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py --num_gpus=2 --model=resnet50 --variable_update=distributed_replicated --data_format=NCHW --batch_size=32 --optimizer=momentum --nodistortions --gradient_repacking=8 --use_fp16 --local_parameter_device=gpu"
  machine-type: "K80"
  count: 1
worker:
  container: "tensorflow/tensorflow:latest-gpu-py3"
  command: "pip install gradient-sdk && python3 scripts/tf_cnn_benchmarks/tf_cnn_benchmarks.py --num_gpus=2 --model=resnet50 --variable_update=distributed_replicated --data_format=NCHW --batch_size=32 --optimizer=momentum --nodistortions --gradient_repacking=8 --use_fp16 --local_parameter_device=gpu"
  machine-type: "P100"
  count: 2

filters:
  branches:
    ignore: ignore-me-*
  tags:
    only:
      - v.*
      - latest